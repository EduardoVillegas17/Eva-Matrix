"use strict";
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (k !== "default" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.TelegramClient = void 0;
const telegramBaseClient_1 = require("./telegramBaseClient");
const authMethods = __importStar(require("./auth"));
const botMethods = __importStar(require("./bots"));
const buttonsMethods = __importStar(require("./buttons"));
const downloadMethods = __importStar(require("./downloads"));
const parseMethods = __importStar(require("./messageParse"));
const messageMethods = __importStar(require("./messages"));
const updateMethods = __importStar(require("./updates"));
const uploadMethods = __importStar(require("./uploads"));
const userMethods = __importStar(require("./users"));
const chatMethods = __importStar(require("./chats"));
const dialogMethods = __importStar(require("./dialogs"));
const tl_1 = require("../tl");
const Utils_1 = require("../Utils");
const markdown_1 = require("../extensions/markdown");
const network_1 = require("../network");
const AllTLObjects_1 = require("../tl/AllTLObjects");
const Helpers_1 = require("../Helpers");
class TelegramClient extends telegramBaseClient_1.TelegramBaseClient {
    // region auth
    start(authParams) {
        return authMethods.start(this, authParams);
    }
    checkAuthorization() {
        return authMethods.checkAuthorization(this);
    }
    signInUser(apiCredentials, authParams) {
        return authMethods.signInUser(this, apiCredentials, authParams);
    }
    signInUserWithQrCode(apiCredentials, authParams) {
        return authMethods.signInUserWithQrCode(this, apiCredentials, authParams);
    }
    sendCode(apiCredentials, phoneNumber, forceSMS = false) {
        return authMethods.sendCode(this, apiCredentials, phoneNumber, forceSMS);
    }
    signInWithPassword(apiCredentials, authParams) {
        return authMethods.signInWithPassword(this, apiCredentials, authParams);
    }
    signInBot(apiCredentials, authParams) {
        return authMethods.signInBot(this, apiCredentials, authParams);
    }
    authFlow(apiCredentials, authParams) {
        return authMethods.authFlow(this, apiCredentials, authParams);
    }
    //endregion auth
    //region bot
    inlineQuery(bot, query, entity, offset, geoPoint) {
        return botMethods.inlineQuery(this, bot, query, entity, offset, geoPoint);
    }
    //endregion
    //region buttons
    buildReplyMarkup(buttons, inlineOnly = false) {
        return buttonsMethods.buildReplyMarkup(buttons, inlineOnly);
    }
    //endregion
    //region download
    downloadFile(inputLocation, fileParams) {
        return downloadMethods.downloadFile(this, inputLocation, fileParams);
    }
    _downloadPhoto(photo, args) {
        return downloadMethods._downloadPhoto(this, photo, args);
    }
    _downloadCachedPhotoSize(size) {
        return downloadMethods._downloadCachedPhotoSize(this, size);
    }
    _downloadDocument(media, args) {
        return downloadMethods._downloadDocument(this, media, args);
    }
    _downloadContact(contact, args) {
        return downloadMethods._downloadContact(this, contact, args);
    }
    _downloadWebDocument(webDocument, args) {
        return downloadMethods._downloadWebDocument(this, webDocument, args);
    }
    downloadMedia(messageOrMedia, args) {
        return downloadMethods.downloadMedia(this, messageOrMedia, args);
    }
    //endregion
    //region message parse
    get parseMode() {
        return this._parseMode || markdown_1.MarkdownParser;
    }
    setParseMode(mode) {
        this._parseMode = Utils_1.sanitizeParseMode(mode);
    }
    // private methods
    _replaceWithMention(entities, i, user) {
        return parseMethods._replaceWithMention(this, entities, i, user);
    }
    _parseMessageText(message, parseMode) {
        return parseMethods._parseMessageText(this, message, parseMode);
    }
    //endregion
    // region messages
    iterMessages(entity, params) {
        return messageMethods.iterMessages(this, entity, params);
    }
    getMessages(entity, params) {
        return messageMethods.getMessages(this, entity, params);
    }
    sendMessage(entity, params) {
        return messageMethods.sendMessage(this, entity, params);
    }
    editMessage(entity, params) {
        return messageMethods.editMessage(this, entity, params);
    }
    //endregion
    //region dialogs
    iterDialogs(params) {
        return dialogMethods.iterDialogs(this, params);
    }
    getDialogs(params) {
        return dialogMethods.getDialogs(this, params);
    }
    //endregion
    //region chats
    iterParticipants(entity, params) {
        return chatMethods.iterParticipants(this, entity, params);
    }
    getParticipants(entity, params) {
        return chatMethods.getParticipants(this, entity, params);
    }
    //endregion
    //region updates
    on(event) {
        return updateMethods.on(this, event);
    }
    addEventHandler(callback, event) {
        return updateMethods.addEventHandler(this, callback, event);
    }
    removeEventHandler(callback, event) {
        return updateMethods.removeEventHandler(this, callback, event);
    }
    listEventHandlers() {
        return updateMethods.listEventHandlers(this);
    }
    // private methods
    _handleUpdate(update) {
        return updateMethods._handleUpdate(this, update);
    }
    _processUpdate(update, others, entities) {
        return updateMethods._processUpdate(this, update, others, entities);
    }
    _dispatchUpdate(args) {
        return updateMethods._dispatchUpdate(this, args);
    }
    _updateLoop() {
        return updateMethods._updateLoop(this);
    }
    //endregion
    // region uploads
    uploadFile(fileParams) {
        return uploadMethods.uploadFile(this, fileParams);
    }
    sendFile(entity, params) {
        return uploadMethods.sendFile(this, entity, params);
    }
    // endregion
    //region user methods
    invoke(request) {
        return userMethods.invoke(this, request);
    }
    getMe(inputPeer = false) {
        return userMethods.getMe(this, inputPeer);
    }
    isBot() {
        return userMethods.isBot(this);
    }
    isUserAuthorized() {
        return userMethods.isUserAuthorized(this);
    }
    getEntity(entity) {
        return userMethods.getEntity(this, entity);
    }
    getInputEntity(peer) {
        return userMethods.getInputEntity(this, peer);
    }
    getPeerId(peer, addMark = false) {
        return userMethods.getPeerId(this, peer, addMark);
    }
    // private methods
    _getEntityFromString(string) {
        return userMethods._getEntityFromString(this, string);
    }
    _getPeer(peer) {
        return userMethods._getPeer(this, peer);
    }
    _getInputDialog(dialog) {
        return userMethods._getInputDialog(this, dialog);
    }
    _getInputNotify(notify) {
        return userMethods._getInputNotify(this, notify);
    }
    //endregion
    //region base methods
    connect() {
        return __awaiter(this, void 0, void 0, function* () {
            yield this._initSession();
            this._sender = new network_1.MTProtoSender(this.session.getAuthKey(), {
                logger: this._log,
                dcId: this.session.dcId || 4,
                retries: this._connectionRetries,
                delay: this._retryDelay,
                autoReconnect: this._autoReconnect,
                connectTimeout: this._timeout,
                authKeyCallback: this._authKeyCallback.bind(this),
                updateCallback: this._handleUpdate.bind(this),
                isMainSender: true,
            });
            const connection = new this._connection(this.session.serverAddress, this.session.port, this.session.dcId, this._log);
            if (!(yield this._sender.connect(connection, this._dispatchUpdate.bind(this)))) {
                return;
            }
            this.session.setAuthKey(this._sender.authKey);
            yield this.session.save();
            this._initRequest.query = new tl_1.Api.help.GetConfig();
            yield this._sender.send(new tl_1.Api.InvokeWithLayer({
                layer: AllTLObjects_1.LAYER,
                query: this._initRequest,
            }));
            this._dispatchUpdate({ update: new network_1.UpdateConnectionState(1) });
            this._updateLoop();
        });
    }
    //endregion
    // region Working with different connections/Data Centers
    _switchDC(newDc) {
        return __awaiter(this, void 0, void 0, function* () {
            this._log.info(`Reconnecting to new data center ${newDc}`);
            const DC = yield this.getDC(newDc);
            this.session.setDC(newDc, DC.ipAddress, DC.port);
            // authKey's are associated with a server, which has now changed
            // so it's not valid anymore. Set to None to force recreating it.
            yield this._sender.authKey.setKey();
            this.session.setAuthKey();
            yield this.disconnect();
            return this.connect();
        });
    }
    _createExportedSender(dcId, retries) {
        return __awaiter(this, void 0, void 0, function* () {
            const dc = yield this.getDC(dcId);
            const sender = new network_1.MTProtoSender(this.session.getAuthKey(dcId), {
                logger: this._log,
                dcId: dcId,
                retries: this._connectionRetries,
                delay: this._retryDelay,
                autoReconnect: this._autoReconnect,
                connectTimeout: this._timeout,
                authKeyCallback: this._authKeyCallback.bind(this),
                isMainSender: dcId === this.session.dcId,
                senderCallback: this.removeSender.bind(this),
            });
            for (let i = 0; i < retries; i++) {
                try {
                    yield sender.connect(new this._connection(dc.ipAddress, dc.port, dcId, this._log));
                    if (this.session.dcId !== dcId) {
                        this._log.info(`Exporting authorization for data center ${dc.ipAddress}`);
                        const auth = yield this.invoke(new tl_1.Api.auth.ExportAuthorization({ dcId: dcId }));
                        this._initRequest.query = new tl_1.Api.auth.ImportAuthorization({
                            id: auth.id,
                            bytes: auth.bytes,
                        });
                        const req = new tl_1.Api.InvokeWithLayer({
                            layer: AllTLObjects_1.LAYER,
                            query: this._initRequest,
                        });
                        yield sender.send(req);
                    }
                    sender.dcId = dcId;
                    return sender;
                }
                catch (e) {
                    yield sender.disconnect();
                }
            }
            throw new Error("Could not create sender for DC " + dcId);
        });
    }
    getDC(dcId) {
        return __awaiter(this, void 0, void 0, function* () {
            if (!Helpers_1.IS_NODE) {
                switch (dcId) {
                    case 1:
                        return {
                            id: 1,
                            ipAddress: "pluto.web.telegram.org",
                            port: 443,
                        };
                    case 2:
                        return {
                            id: 2,
                            ipAddress: "venus.web.telegram.org",
                            port: 443,
                        };
                    case 3:
                        return {
                            id: 3,
                            ipAddress: "aurora.web.telegram.org",
                            port: 443,
                        };
                    case 4:
                        return {
                            id: 4,
                            ipAddress: "vesta.web.telegram.org",
                            port: 443,
                        };
                    case 5:
                        return {
                            id: 5,
                            ipAddress: "flora.web.telegram.org",
                            port: 443,
                        };
                    default:
                        throw new Error(`Cannot find the DC with the ID of ${dcId}`);
                }
            }
            if (!this._config) {
                this._config = yield this.invoke(new tl_1.Api.help.GetConfig());
            }
            for (const DC of this._config.dcOptions) {
                if (DC.id === dcId && !!DC.ipv6 === this._useIPV6) {
                    return {
                        id: DC.id,
                        ipAddress: DC.ipAddress,
                        port: 443,
                    };
                }
            }
            throw new Error(`Cannot find the DC with the ID of ${dcId}`);
        });
    }
    removeSender(dcId) {
        delete this._borrowedSenderPromises[dcId];
    }
    _borrowExportedSender(dcId, retries = this._requestRetries) {
        return __awaiter(this, void 0, void 0, function* () {
            let senderPromise = this._borrowedSenderPromises[dcId];
            if (!senderPromise) {
                senderPromise = this._createExportedSender(dcId, retries);
                this._borrowedSenderPromises[dcId] = senderPromise;
                senderPromise.then((sender) => {
                    if (!sender) {
                        delete this._borrowedSenderPromises[dcId];
                    }
                });
            }
            return senderPromise;
        });
    }
}
exports.TelegramClient = TelegramClient;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGVsZWdyYW1DbGllbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9ncmFtanMvY2xpZW50L1RlbGVncmFtQ2xpZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSw2REFBMEQ7QUFFMUQsb0RBQXNDO0FBQ3RDLG1EQUFxQztBQUNyQywwREFBNEM7QUFDNUMsNkRBQStDO0FBQy9DLDZEQUErQztBQUMvQywyREFBNkM7QUFDN0MseURBQTJDO0FBQzNDLHlEQUEyQztBQUMzQyxxREFBdUM7QUFDdkMscURBQXVDO0FBQ3ZDLHlEQUEyQztBQUUzQyw4QkFBNEI7QUFDNUIsb0NBQTZDO0FBQzdDLHFEQUF3RDtBQUV4RCx3Q0FBa0U7QUFFbEUscURBQTJDO0FBQzNDLHdDQUFxQztBQUlyQyxNQUFhLGNBQWUsU0FBUSx1Q0FBa0I7SUFDbEQsY0FBYztJQUVkLEtBQUssQ0FBQyxVQUFrRTtRQUNwRSxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQy9DLENBQUM7SUFFRCxrQkFBa0I7UUFDZCxPQUFPLFdBQVcsQ0FBQyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNoRCxDQUFDO0lBRUQsVUFBVSxDQUNOLGNBQTBDLEVBQzFDLFVBQXNDO1FBRXRDLE9BQU8sV0FBVyxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsY0FBYyxFQUFFLFVBQVUsQ0FBQyxDQUFDO0lBQ3BFLENBQUM7SUFFRCxvQkFBb0IsQ0FDaEIsY0FBMEMsRUFDMUMsVUFBc0M7UUFFdEMsT0FBTyxXQUFXLENBQUMsb0JBQW9CLENBQ25DLElBQUksRUFDSixjQUFjLEVBQ2QsVUFBVSxDQUNiLENBQUM7SUFDTixDQUFDO0lBRUQsUUFBUSxDQUNKLGNBQTBDLEVBQzFDLFdBQW1CLEVBQ25CLFFBQVEsR0FBRyxLQUFLO1FBRWhCLE9BQU8sV0FBVyxDQUFDLFFBQVEsQ0FD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